---
- name: Macock setup
  hosts: localhost
  become: false # sudo global falso
  connection: local
  gather_facts: true
  vars:
    regular_user: "{{ ansible_env.SUDO_USER or ansible_user }}"
    package_manager:
      MacOS: homebrew

  tasks:
  # - name: Get my user
  #   set_fact:
  #     remote_regular_user: "{{ ansible_env.SUDO_USER or ansible_user_id }}"

  - name: Exibir distribuição do sistema operacional
    debug:
      msg: "Distribuição {{ ansible_distribution }} do sistema {{ ansible_system }}"

  - name: APT Install common packages for Raspberry Pi and Linux
    become: true
    block:
      - name: Install Homebrew
        shell:
          cmd: /bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"
        args:
          creates: /usr/local/bin/brew  # Verifica se o Homebrew já está instalado

      - name: Run Brewfile
        shell:
          cmd: brew bundle --file="./dot_bootstrap/macock/Brewfile-clean"
