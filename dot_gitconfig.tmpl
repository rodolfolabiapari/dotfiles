# -*- mode:toml; tab-with=2; indent-tabs-mode=0; -*-
# vim:ft=toml

# =============================================================================
# User configuration
# =============================================================================
[user]
  email = {{ .email | quote }}
  name = {{ .username | quote }}
  {{ if (and (eq .chezmoi.arch "arm64") (eq .chezmoi.os "darwin") ) -}}
  signingkey = {{ .chezmoi.homeDir }}/.ssh/id_rsa.pub
  {{ else }}
  signingkey = {{ .signkey | quote }}
  {{ end -}}

[gpg]
  {{ if (and (eq .chezmoi.arch "arm64") (eq .chezmoi.os "darwin") ) -}}
  format = ssh
  {{- else }}
  program = gpg
  {{- end }}

[commit]
  # Enable commit signing by default
  gpgsign = true
  verbose = true

# =============================================================================
# Core Git Configuration
# =============================================================================
[core]
  # Store global exclusions into a custom file
  #excludesfile = ~/.gitignore_global
  editor = nvim
  # o diff tem override abaixo
  pager = less
  preloadindex = true

#[rerere]
 # enabled = true
 # autoupdate = true

# =============================================================================
# Credentials Configuration
# =============================================================================
[credential]
  # Store credentials to not ask everytime
  helper = store

# =============================================================================
# Diff e Difftoll
# =============================================================================
[diff]
  tool = nvimdiff
  # O Git para de olhar linhas isoladas e olha "pacotes" de texto.
  # Se você tem uma função A e B, e inverte a ordem delas, o diff padrão surta.
  # O histograma entende que elas só trocaram de lugar e muitas vezes faz o
  # merge automático sem te perguntar nada.
  algorithm = histogram
  # Tenta detectar código movido e colorir diferente
  colorMoved = default

# Diff tool configuration
[difftool]
  # Allow aborting all diffs with `:cq` or `:cquit`
  trustExitCode = true
  prompt = false

[difftool "nvimdiff"]
  cmd = nvim -d "$REMOTE" "$LOCAL"

# Pager configuration for diff
[pager]
  diff =

# =============================================================================
# Merge e Rebase Configuration
# =============================================================================
[merge]
  conflictstyle = merge
  strategy = org
  log = false
  # FF true não faz merge nas divergencias. Ideal pra usar com rebase
  # Se tiver atrapalhando muito, colocar false
  ff = true
  # Define que a ferramenta de merge será o nvim
  tool = nvimdiff

# Define configuracoes gerais para mergetool
[mergetool]
  prompt = false
  keepBackup = false

# Define que minha ferramenta de merge é o nvim -d
# essa ferramenta é definida no merge.tool
# para utilizar, executar o comando "git mergetool"
[mergetool "nvimdiff"]
  #cmd = nvim -d $LOCAL $BASE $REMOTE $MERGED -c \"wincmd l\"
  # layout = "LOCAL,BASE,REMOTE / MERGED"
  cmd = nvim -d "$MERGED" "$LOCAL" "$REMOTE"
  layout = "MERGED,LOCAL,REMOTE"
  # cmd = nvim -d "$REMOTE" "$MERGED" -c "wincmd w" -c "wincmd H"

[rebase]
  # Automatically stash changes before rebasing
  autoStash = true
  autosquash = true
  updateRefs = true

[pull]
  rebase = true
  # FF true não faz merge nas divergencias. Ideal pra usar com rebase
  ff = only

# =============================================================================
# Push, Branch, Fetch
# =============================================================================
[push]
  default = current
  autoSetupRemote = true

[remote]
  pushDefault = origin

[branch]
  autosetupmode = always

[fetch]
  # Remove any remote-tracking references that no longer exist on the remote
  prune = true

# =============================================================================
# Help, status, init, http
# =============================================================================
# Help settings
[help]
  # Enable autocorrection for mistyped commands
  autocorrect = 1

# Default branch name for new repositories
[init]
  defaultBranch = master

# Color UI settings
[color]
  ui = auto

# Configuracao para Acessar o Source Repository do Google Cloud Platform
[http]
  cookiefile = ~/.gitcookies

[status]
  branch = true
  showStash = true
  showUntrackedFiles = all
  submoduleSummary = true

# =============================================================================
# Includes
# =============================================================================

# Include external configuration files
[include]
  # Include Git aliases configuration
  path = ~/.git.d/alias
  # Include any additional Git configuration
  path = ~/.git.d/message


# Para funcionar em repositórios já existentes, deve-se executar o comando
#abaixo para apagar os dados dos repositórios locais pois eles possuem
#prioridade
#git config --local --unset user.email
[includeIf "gitdir:~/g/l/"]
  path = ~/.git.d/lxp
